<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MASTER X | Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { background: #000; color: white; font-family: 'Cairo', sans-serif; }
        input { background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); width: 100%; padding: 15px; margin-bottom: 15px; border-radius: 12px; color: white; text-align: center; }
        input:focus { outline: none; border-color: #dc2626; }
    </style>
</head>
<body class="flex flex-col justify-center items-center h-screen p-4">
    <div class="text-center w-full max-w-sm">
        <h1 class="text-5xl font-black text-red-500 mb-10 italic tracking-tighter">MASTER X</h1>
        
        <input type="text" id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
        <input type="password" id="pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
        <input type="text" id="nick" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ù„Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯)">

        <button onclick="auth()" class="w-full bg-red-600 p-4 rounded-xl font-black text-lg">Ø¯Ø®ÙˆÙ„ / Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ ðŸš€</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
        import { getDatabase, ref, get, set } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";
        
        const db = getDatabase(initializeApp({
            apiKey: "AIzaSyCd6mOpEJyiUSAAhmm2NbhT80MMY0UQJcc",
            databaseURL: "https://project-fe025bb5-b1cc-4b8f-93e-default-rtdb.firebaseio.com"
        }));

        window.auth = () => {
            const phone = document.getElementById('phone').value;
            const pass = document.getElementById('pass').value;
            const nick = document.getElementById('nick').value || "Ù…Ø³ØªØ®Ø¯Ù…";
            
            if(!phone || !pass) return alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ù‡Ø§ØªÙ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±!");
            
            const userRef = ref(db, 'ZEYKOR/users/' + phone);
            
            get(userRef).then(snap => {
                if(snap.exists()) {
                    // ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„
                    if(snap.val().password === pass) {
                        localStorage.setItem('zeykor_phone', phone);
                        window.location.href = "index.html";
                    } else {
                        alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø·Ø£!");
                    }
                } else {
                    // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯
                    set(userRef, {
                        balance: 0,
                        password: pass,
                        nick: nick
                    }).then(() => {
                        localStorage.setItem('zeykor_phone', phone);
                        alert("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­!");
                        window.location.href = "index.html";
                    });
                }
            });
        };
    </script>
</body>
</html>
