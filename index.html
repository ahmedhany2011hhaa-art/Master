<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MASTER X | Home</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { background: #050505; color: white; font-family: 'Cairo', sans-serif; overflow-x: hidden; }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.08); }
        .glow-red { box-shadow: 0 0 20px rgba(220, 38, 38, 0.2); }
        .hack-card { transition: 0.3s; }
        .hack-card:active { transform: scale(0.97); }
        input { background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); padding: 12px; border-radius: 12px; color: white; }
    </style>
</head>
<body class="p-3 pb-20">

    <div id="login-screen" class="fixed inset-0 bg-black z-50 flex flex-col justify-center p-6 text-center">
        <h1 class="text-4xl font-black text-red-500 mb-8 italic">MASTER X</h1>
        <input type="text" id="phone-input" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ" class="w-full mb-4 text-center">
        <input type="text" id="nick-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" class="w-full mb-6 text-center">
        <button onclick="login()" class="w-full bg-red-600 p-4 rounded-xl font-bold text-white">Ø¯Ø®ÙˆÙ„ ğŸš€</button>
    </div>

    <div id="main-content" class="hidden">
        <header class="glass p-4 rounded-2xl flex justify-between items-center mb-5 sticky top-2 z-40">
            <h1 class="text-2xl font-black text-red-500 italic tracking-tighter">SUKUNA</h1>
            <div class="glass px-4 py-2 rounded-full font-bold flex items-center gap-2 text-sm">
                <span id="u-balance" class="text-white">0</span> ğŸª™
            </div>
        </header>

        <section class="glass p-5 rounded-3xl text-center mb-5 glow-red">
            <p class="text-zinc-400 text-xs tracking-widest uppercase">Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨</p>
            <p class="text-5xl font-black text-white mb-3"><span id="u-balance-big">0</span> ğŸª™</p>
            <button onclick="requestWithdraw()" class="w-full bg-green-600 p-3 rounded-xl font-bold text-white text-sm">Ø·Ù„Ø¨ Ø³Ø­Ø¨ Ù†Ù‚ÙˆØ¯ ğŸ’°</button>
        </section>

        <section class="grid grid-cols-2 gap-3 mb-6">
            <a href="./plinko.html" class="glass p-4 rounded-2xl text-center flex flex-col items-center">
                <div class="text-5xl mb-2">ğŸ°</div>
                <p class="font-bold text-sm">Ø¨Ù„ÙŠÙ†ÙƒÙˆ</p>
            </a>
            <a href="./crash.html" class="glass p-4 rounded-2xl text-center flex flex-col items-center">
                <div class="text-5xl mb-2">âœˆï¸</div>
                <p class="font-bold text-sm">Ø§Ù„Ø·ÙŠØ§Ø±Ø©</p>
            </a>
        </section>

        <section>
            <h2 class="text-xl font-black mb-4 tracking-tight">Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© ğŸ› ï¸</h2>
            <div id="hacks-grid" class="grid grid-cols-2 gap-3"></div>
        </section>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
        import { getDatabase, ref, onValue, update, get, set } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCd6mOpEJyiUSAAhmm2NbhT80MMY0UQJcc",
            databaseURL: "https://project-fe025bb5-b1cc-4b8f-93e-default-rtdb.firebaseio.com"
        };
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        
        let currentUserPhone = localStorage.getItem('zeykor_phone');

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
        if (currentUserPhone) {
            showMainContent();
        }

        window.login = () => {
            const phone = document.getElementById('phone-input').value;
            const nick = document.getElementById('nick-input').value || "Ù…Ø³ØªØ®Ø¯Ù…";
            if (!phone) return alert("Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ!");

            localStorage.setItem('zeykor_phone', phone);
            currentUserPhone = phone;

            // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
            get(ref(db, 'ZEYKOR/users/' + phone)).then(snap => {
                if (!snap.exists()) {
                    set(ref(db, 'ZEYKOR/users/' + phone), { balance: 0, nick: nick });
                }
                showMainContent();
            });
        };

        function showMainContent() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('main-content').classList.remove('hidden');
            loadUserData();
        }

        function loadUserData() {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ØµÙŠØ¯ Ù„Ø­Ø¸ÙŠØ§Ù‹
            onValue(ref(db, 'ZEYKOR/users/' + currentUserPhone), (snap) => {
                const data = snap.val();
                const balance = data ? data.balance : 0;
                document.getElementById('u-balance').innerText = balance;
                document.getElementById('u-balance-big').innerText = balance;
            });
        }

        // Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø¯ÙˆØ§Øª ÙˆØ¥Ø¸Ù‡Ø§Ø±Ù‡Ø§
        onValue(ref(db, 'ZEYKOR/hacks'), (snap) => {
            const grid = document.getElementById('hacks-grid');
            grid.innerHTML = "";
            snap.forEach(child => {
                const h = child.val();
                const hId = child.key;
                grid.innerHTML += `
                    <div class="glass p-4 rounded-2xl text-center hack-card flex flex-col justify-between">
                        <div>
                            <div class="text-3xl mb-2">ğŸš€</div>
                            <p class="font-bold text-xs text-white">${h.name}</p>
                        </div>
                        <p class="text-red-400 font-black text-lg my-2">${h.price} ğŸª™</p>
                        <button onclick="buyHack('${hId}', ${h.price}, '${h.fileUrl}')" class="bg-red-600 text-white w-full rounded-xl text-xs p-2.5 font-bold">Ø´Ø±Ø§Ø¡ ÙˆØªØ­Ù…ÙŠÙ„</button>
                    </div>
                `;
            });
        });

        // Ø¯Ø§Ù„Ø© Ø§Ù„Ø´Ø±Ø§Ø¡ ÙˆØ§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
        window.buyHack = (hId, price, fileUrl) => {
            if(!fileUrl || fileUrl === "") return alert("Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…ØªØ§Ø­ Ø­Ø§Ù„ÙŠØ§Ù‹!");

            get(ref(db, 'ZEYKOR/users/' + currentUserPhone)).then(snap => {
                let balance = snap.val()?.balance || 0;
                if(balance < price) return alert("Ø±ØµÙŠØ¯Ùƒ Ù„Ø§ ÙŠÙƒÙÙŠ!");

                // Ø®ØµÙ… Ø§Ù„Ù†Ù‚Ø§Ø·
                update(ref(db, 'ZEYKOR/users/' + currentUserPhone), { balance: balance - price });
                
                alert("ØªÙ… Ø®ØµÙ… Ø§Ù„Ù†Ù‚Ø§Ø·! Ø¬Ø§Ø±Ù Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù…Ø¨Ø§Ø´Ø±Ø©...");
                
                // ØªØ­Ù…ÙŠÙ„ Ù…Ø¨Ø§Ø´Ø± ÙÙŠ Ù†ÙØ³ Ø§Ù„ØµÙØ­Ø©
                window.location.href = fileUrl;
            });
        };

        window.requestWithdraw = () => { alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©! Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ."); };
    </script>
</body>
</html>
