<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MASTER X | Home</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { background: #050505; color: white; font-family: 'Cairo', sans-serif; overflow-x: hidden; }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.08); }
        .glow-red { box-shadow: 0 0 20px rgba(220, 38, 38, 0.2); }
        .hack-card { transition: 0.3s; }
        .hack-card:active { transform: scale(0.97); }
    </style>
</head>
<body class="p-3 pb-20">

    <header class="glass p-4 rounded-2xl flex justify-between items-center mb-5 sticky top-2 z-40">
        <h1 class="text-2xl font-black text-red-500 italic tracking-tighter">SUKUNA</h1>
        <div class="glass px-4 py-2 rounded-full font-bold flex items-center gap-2 text-sm">
            <span id="u-balance" class="text-white">0</span> ğŸª™
        </div>
    </header>

    <section class="glass p-5 rounded-3xl text-center mb-5 glow-red">
        <p class="text-zinc-400 text-xs tracking-widest uppercase">Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨</p>
        <p class="text-5xl font-black text-white mb-3"><span id="u-balance-big">0</span> ğŸª™</p>
        <button onclick="watchAd()" class="w-full bg-yellow-500 text-black p-3 rounded-xl font-bold text-sm">Ø´Ø§Ù‡Ø¯ Ø¥Ø¹Ù„Ø§Ù† ÙˆØ§ÙƒØ³Ø¨ Ù†Ù‚Ø§Ø· ğŸ</button>
    </section>

    <section class="grid grid-cols-2 gap-3 mb-6">
        <a href="./plinko.html" class="glass p-4 rounded-2xl text-center flex flex-col items-center">
            <div class="text-5xl mb-2">ğŸ°</div>
            <p class="font-bold text-sm">Ø¨Ù„ÙŠÙ†ÙƒÙˆ</p>
        </a>
        <a href="./crash.html" class="glass p-4 rounded-2xl text-center flex flex-col items-center">
            <div class="text-5xl mb-2">âœˆï¸</div>
            <p class="font-bold text-sm">Ø§Ù„Ø·ÙŠØ§Ø±Ø©</p>
        </a>
    </section>

    <section>
        <h2 class="text-xl font-black mb-4 tracking-tight">Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© ğŸ› ï¸</h2>
        <div id="hacks-grid" class="grid grid-cols-2 gap-3"></div>
    </section>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
        import { getDatabase, ref, onValue, update, get } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";

        const db = getDatabase(initializeApp({
            apiKey: "AIzaSyCd6mOpEJyiUSAAhmm2NbhT80MMY0UQJcc",
            databaseURL: "https://project-fe025bb5-b1cc-4b8f-93e-default-rtdb.firebaseio.com"
        }));
        
        const phone = localStorage.getItem('zeykor_phone');
        if(!phone) window.location.href = "login.html";

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ØµÙŠØ¯ Ù„Ø­Ø¸ÙŠØ§Ù‹
        onValue(ref(db, 'ZEYKOR/users/' + phone), (snap) => {
            const b = snap.val()?.balance || 0;
            document.getElementById('u-balance').innerText = b;
            document.getElementById('u-balance-big').innerText = b;
        });

        // Ø¯Ø§Ù„Ø© Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
        window.watchAd = () => {
            alert("Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù„Ø¯Ø¹Ù… Ø§Ù„ØªØ·ÙˆÙŠØ±... (Ø³ÙŠÙØªØ­ ÙÙŠ ØµÙØ­Ø© Ø¬Ø¯ÙŠØ¯Ø©)");
            
            // ÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„ØªÙŠ Ø£Ù†Ø´Ø£Ù†Ø§Ù‡Ø§
            window.open("ad_page.html", "_blank");
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù‚Ø§Ø· (Ù…Ø­Ø§ÙƒØ§Ø©)
            setTimeout(() => {
                get(ref(db, 'ZEYKOR/config/adPoints')).then(snap => {
                    const points = snap.val() || 50; 
                    get(ref(db, 'ZEYKOR/users/' + phone)).then(userSnap => {
                        const curBal = userSnap.val().balance;
                        update(ref(db, 'ZEYKOR/users/' + phone), { balance: curBal + points });
                        alert(`Ù…Ø¨Ø±ÙˆÙƒ! Ø­ØµÙ„Øª Ø¹Ù„Ù‰ ${points} Ù†Ù‚Ø§Ø· Ø¯Ø¹Ù…!`);
                    });
                });
            }, 10000); // 10 Ø«ÙˆØ§Ù†ÙŠ Ù…Ø­Ø§ÙƒØ§Ø©
        };

        // Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø¯ÙˆØ§Øª
        onValue(ref(db, 'ZEYKOR/hacks'), (snap) => {
            const grid = document.getElementById('hacks-grid');
            grid.innerHTML = "";
            snap.forEach(child => {
                const h = child.val();
                const hId = child.key;
                grid.innerHTML += `
                    <div class="glass p-4 rounded-2xl text-center hack-card flex flex-col justify-between">
                        <div>
                            <div class="text-3xl mb-2">ğŸš€</div>
                            <p class="font-bold text-xs text-white">${h.name}</p>
                        </div>
                        <p class="text-red-400 font-black text-lg my-2">${h.price} ğŸª™</p>
                        <button onclick="buyHack('${hId}', ${h.price}, '${h.fileUrl}')" class="bg-red-600 text-white w-full rounded-xl text-xs p-2.5 font-bold">Ø´Ø±Ø§Ø¡ ÙˆØªØ­Ù…ÙŠÙ„</button>
                    </div>
                `;
            });
        });

        window.buyHack = (hId, price, fileUrl) => {
            if(!fileUrl || fileUrl === "") return alert("Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…ØªØ§Ø­ Ø­Ø§Ù„ÙŠØ§Ù‹!");
            get(ref(db, 'ZEYKOR/users/' + phone)).then(snap => {
                let balance = snap.val()?.balance || 0;
                if(balance < price) return alert("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±ØµÙŠØ¯ ÙƒØ§ÙÙŠ!");
                update(ref(db, 'ZEYKOR/users/' + phone), { balance: balance - price });
                alert("ØªÙ… Ø®ØµÙ… Ø§Ù„Ù†Ù‚Ø§Ø·! Ø¬Ø§Ø±Ù Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù…Ø¨Ø§Ø´Ø±Ø©...");
                window.location.href = fileUrl;
            });
        };
    </script>
</body>
</html>
